Adapted from ml-daikon-input-programs/accelerate/complete_nlp_example